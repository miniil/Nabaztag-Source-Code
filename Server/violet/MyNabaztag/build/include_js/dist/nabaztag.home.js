var DuppRemoveLine=function(){$(this).parents("tr.line-duplicate").remove();if($("tr.line-duplicate").length<10){$("a.bt_AddFoyer").show();return }};var DuppAddLine=function(){var A=false;var B=$("tr.line-duplicate:last");$("input, select",B).not("[@type=hidden][@type=button]").each(function(){if($(this).val()==""){A=true}});var C=$("tr.line-duplicate:last").clone();$("select, input[@type!=button]",C).val("");$("span",C).remove();$("a.bt_Remove",C).show();$("a.bt_Remove",C).bind("click",DuppRemoveLine);if($("tr.line-duplicate").length<10-1){}else{$(this).hide()}$(C).appendTo("#line-duplicate-contener table")};register=function(){var E=false;var D="nabaztag";var A="";var C="200";var B="";return{initRecupSerialForm:function(){msgHandling.errorMsgShow();$("#recupForm a.form-submit").click(function(){regRecoverValidate();return false});$("#backToMainForm").click(function(){$("#recupForm").html("");$("#bigMainForm form").unblock();$("#bigMainForm").show();$("#pseudoId").val(register.savedPseudo);$("#dispatch").val("insertUser");return false})},recupSerial:function(){register.savedPseudo=$("#pseudoId").val();$("#floatingMessage").remove();$("#pseudoId").val("");var F={target:"#recupForm",beforeSubmit:beforeFormAction,success:function(){$("#bigMainForm").hide();register.initRecupSerialForm()}};$("#dispatch").val("goGetAccountMac");$("#registerProfil").ajaxSubmit(F);return false},goStart:function(F){$(".contentMainTab").hide();$("#contentCreerCompte").show();divChangeUrl("contentCreerCompte","registerMain.do?dispatch=startUp",function(){register.init(F)})},goMainReg:function(F){$(".contentMainTab").hide();$("#contentCreerCompte").show();divChangeUrl("contentCreerCompte","registerMain.do?dispatch=insertUser",function(){register.init(F)})},goVieCommune:function(F){$(".contentMainTab").hide();$("#contentCreerCompte").show();divChangeUrl("contentCreerCompte","myRegisterWizard.do?dispatch=load",function(){register.init(F)})},goPreferences:function(G,F){$(".contentMainTab").hide();$("#contentCreerCompte").show();if(G==null){G=false}if(G==true){divChangeUrl("contentCreerCompte","myRegisterWizard.do?dispatch=skip&listInterets=2",function(){register.init(F)})}else{divChangeUrl("contentCreerCompte","myRegisterInfo.do?dispatch=load",function(){register.init(F)})}},goMusicUpload:function(F){$(".contentMainTab").hide();$("#contentCreerCompte").show();divChangeUrl("contentCreerCompte","myRegisterMp3.do",function(){register.init(F)})},goFriends:function(F){$(".contentMainTab").hide();$("#contentCreerCompte").show();divChangeUrl("contentCreerCompte","myRegisterFriends.do?dispatch=load",function(){register.init(F)})},goMyself:function(F,G){$(".contentMainTab").hide();$("#contentCreerCompte").show();if(G){divChangeUrl("contentCreerCompte","myRegisterProfil.do?dispatch=skip",function(){register.init(F)})}else{divChangeUrl("contentCreerCompte","myRegisterProfil.do?dispatch=load",function(){register.init(F)})}},goRecap:function(F){$(".contentMainTab").hide();$("#contentCreerCompte").show();divChangeUrl("contentCreerCompte","myRegisterRecap.do?dispatch=load",function(){register.init(F)})},goDeathTunel:function(){$(".contentMainTab").hide();$("#contentCreerCompte").show();divChangeUrl("contentCreerCompte","../include_jsp/myRegister/static_rabbitPlugHelp.jsp?macAddress=eeeeeeeeeee3&rabbName",function(){register.init()})},goEndHelp:function(F){$(".contentMainTab").hide();$("#contentCreerCompte").show();divChangeUrl("contentCreerCompte","myRegisterHelp.do?dispatch=load",function(){register.init(F)})},goVraiFinFinal:function(){$(".contentMainTab").hide();$("#contentCreerCompte").show();divChangeUrl("contentCreerCompte","../include_jsp/myRegister/static_wizard_last_real_fnal_end.jsp",function(){register.init()})},init_rabbit:function(G){var H=new SWFObject("../include_flash/CDLEditor.swf","flashNab","270","270","7",null,true);if($("#nabInscriptionFlash").length>0){H.addVariable("cdll",A);H.addParam("wmode","transparent");if(!H.write("nabInscriptionFlash")){var F=document.getElementById("nabInscriptionFlash");if(F){F.innerHTML=H.getSWFHTML()}}}},init:function(J,Q){goToTheTopOfThePage();$("#spokenLanguage").hide();$("a.form-submit").click(function(){$("#contentCreerCompte form").submit()});register.userObject=(J!=null)?J:register.userObject;if(register.userObject==null||register.userObject==""){register.userObject="nabaztag"}if(register.userObject=="nabaztag"){$("#bloc-generic-register").show()}else{$("#bloc-generic-register").remove()}$("#contentCreerCompte input[@id^=bt_]").unbind();$("#contentCreerCompte form, #contentCreerCompte select, #contentCreerCompte input").unbind();$("#spokenLanguage").unbind();$("#spokenLanguage").change(function(){var R=$(this).val();var S=Url.argReplace("langUser",R);redirect(S)});register.init_rabbit();if(gCheckInterval!=null){clearInterval(gCheckInterval);gCheckInterval=null}$("ul.radio-chooser").rabbitChooser();$("#contentCreerCompte input.hourPicker").hourSelect_Init(true,false);$("textarea.formToolTip, input.formToolTip, select.formToolTip").formToolTip();var L=$("#whereAreWe").val();if(Q!=null){L=Q}var K=null;$("#bloc-generic-register ul li").eq(2).hide();$("#bloc-generic-register ul li").eq(8).hide();$("#bloc-generic-register ul li").removeClass("reg-weAreHere");$("#bloc-generic-register ul li").removeClass("reg-weAreNotHere");var M=$("<img class='wizard-img-indic' src='../include_img/layout/wizard_progress_bar_rabbit.png' />");$("img.wizard-img-indic").remove();$("#bloc-generic-register ul li:first").prepend(M);if(($.browser.msie&&ie7)||(!($.browser.msie))&&L!="vrai_fin_finale"){if($("img.wizard-img-indic").length==0){setTimeout(function(){$("#bloc-generic-register ul li:first").prepend(M)},1000)}}$("#floatingMessage").remove();switch(L){case"start":$("#spokenLanguage").show();$("#bloc-generic-register ul li").eq(0).addClass("reg-weAreHere");$("#bt_RegisterGoMain").bind("click",function(){var R=$(this).parents("div.contentMainTab");$(R).block();$(R).load("registerMain.do",{dispatch:"insertUser",object:register.userObject},function(){register.init()})});break;case"main":mainMenuSwitch("hide");$("#mainLogo a").click(function(){customConfirmN(msg_txt["abort_wizard"],"&nbsp;",function(){redirect("myNablife.do")});return false});$("#spokenLanguage").show();$("#bloc-generic-register ul li").eq(1).addClass("reg-weAreHere");$("div.intro-cadre-content img").setOpacity(0.4);$("#city-contener").hide();var P={"US":{h24:0,zone:5},"DE":{h24:1,zone:29},"ES":{h24:1,zone:30},"FR":{h24:1,zone:30},"IT":{h24:1,zone:29},"UK":{h24:1,zone:27},"BR":{h24:1,zone:22}};$("#registerProfil select[@name='countryId']").bind("change",function(){var R=$(this).val();$("#pays-contener").append("<img id='ville-load' align='absmiddle' style='border:none; margin:3px 0 0 5px;' alt='' height='20' width='20' src='../include_img/loading.gif'>");$("#city-contener span.cities").load("registerMain.do",{dispatch:"getListVille",countryId:R},function(U){$("#ville-load").remove();var T=$.trim(U);if(T.length>0){$("#city-contener").show();$("#city-contener select.formToolTip").formToolTip()}else{$("#city-contener").hide()}});var S=P[R];if(S!=null){$("#timeZone").val(S.zone);nabaztag.constantes.H24=S.h24}});var G={target:"#contentCreerCompte",beforeSubmit:function(S,R,T){if(regMainValidate()){beforeFormAction(S,R,T)}else{return false}},success:function(){register.init();if(register.userObject=="none"){$("#rabbitBlock").remove()}msgHandling.errorMsgShow()}};$("#registerProfil").ajaxForm(G);break;case"help":case"death_tunnel":if(gPlatform=="win"||gPlatform=="linux"){$("div.wifi-help-win").show()}else{$("div.wifi-help-mac").show()}$("a.more-help-link").bind("click",function(){var R=$(this).parents("div").eq(0).find("div.reg-help-more");$(R).toggle();return false});$("a.plateforme-switch").bind("click",function(){$("div.wifi-help-win").toggle();$("div.wifi-help-mac").toggle();return false});$("#bloc-generic-register ul li").eq(2).show();$("#bloc-generic-register ul li").eq(2).addClass("reg-weAreHere");break;case"endHelp":$("a.print_all").bind("click",function(){$("div.reg-help-more").show();popupFromPage("#contentCreerCompte",true);$("div.reg-help-more").hide();return false});$("a.connect_later").bind("click",function(){register.goVraiFinFinal();return false});$("a.more-help-link").bind("click",function(){var R=$(this).parents("li").find("div.reg-help-more");$(R).toggle();return false});$("#bloc-generic-register ul li").eq(8).show();$("#bloc-generic-register ul li").eq(8).addClass("reg-weAreHere");var I;var O=new Array();O[0]="long,3,none,nomusic.mid,1,7,0,led,4,255,153,0,0,led,3,255,153,0,0,led,2,255,153,0,0,led,1,255,153,0,0,led,0,255,153,0,2,led,4,0,0,0,2,led,3,0,0,0,2,led,2,0,0,0,2,led,1,0,0,0,2,led,0,0,0,0,4,led,4,255,153,0,4,led,3,255,153,0,4,led,2,255,153,0,4,led,1,255,153,0,4,led,0,255,153,0,6,led,4,0,0,0,6,led,3,0,0,0,6,led,2,0,0,0,6,led,1,0,0,0,6,led,0,0,0,0,8,led,4,255,153,0,8,led,3,255,153,0,8,led,2,255,153,0,8,led,1,255,153,0,8,led,0,255,153,0,10,led,4,0,0,0,10,led,3,0,0,0,10,led,2,0,0,0,10,led,1,0,0,0,10,led,0,0,0,0,12,led,0,0,0,0,12,led,1,0,0,0,12,led,2,0,0,0,12,led,3,0,0,0,12,led,4,0,0,";O[1]="long,3,none,nomusic.mid,0,7,0,led,4,255,204,0,0,led,3,255,204,0,0,led,2,255,204,0,0,led,1,255,153,0,0,led,0,255,153,0,1,led,1,0,0,0,1,led,0,0,0,0,2,led,1,255,153,0,2,led,0,255,153,0,3,led,1,0,0,0,3,led,0,0,0,0,4,led,1,255,153,0,4,led,0,255,153,0,5,led,1,0,0,0,5,led,0,0,0,0,6,led,1,255,153,0,6,led,0,255,153,0,7,led,1,0,0,0,7,led,0,0,0,0,8,led,2,0,0,0,8,led,1,0,238,0,8,led,0,255,153,0,9,led,0,0,0,0,9,led,2,255,153,0,10,led,2,0,0,0,10,led,0,255,153,0,11,led,0,0,0,0,11,led,2,255,153,0,12,led,2,0,0,0,12,led,0,255,153,0,13,led,0,0,0,0,13,led,2,255,153,0,14,led,2,0,0,0,14,led,0,255,153,0,15,led,0,0,0,0,15,led,2,255,153,0,16";O[2]="long,3,none,nomusic.mid,0,7,0,led,4,255,204,0,0,led,3,255,204,0,0,led,2,255,204,0,0,led,1,255,153,0,0,led,0,255,153,0,1,led,1,0,0,0,1,led,0,0,0,0,2,led,1,255,153,0,2,led,0,255,153,0,3,led,1,0,0,0,3,led,0,0,0,0,4,led,1,255,153,0,4,led,0,255,153,0,5,led,1,0,0,0,5,led,0,0,0,0,6,led,1,255,153,0,6,led,0,255,153,0,7,led,1,0,0,0,7,led,0,0,0,0,8,led,2,0,0,0,8,led,1,0,238,0,8,led,0,255,153,0,9,led,0,0,0,0,9,led,2,255,153,0,10,led,2,0,0,0,10,led,0,255,153,0,11,led,0,0,0,0,11,led,2,255,153,0,12,led,2,0,0,0,12,led,0,255,153,0,13,led,0,0,0,0,13,led,2,255,153,0,14,led,2,0,0,0,14,led,0,255,153,0,15,led,0,0,0,0,15,led,2,255,153,0,16,led,2,0,0,0,16,led,0,255,153,0,17,led,0,0,0,0,17,led,2,255,153,0,18,led,2,0,0,0,18,led,0,255,153,0,19,led,3,0,0,0,19,led,0,0,0,0,19,led,2,0,238,0,20,led,3,255,153,0,20,led,0,255,153,0,21,led,3,0,0,0,21,led,0,0,0,0,22,led,3,255,153,0,22,led,0,255,153,0,23,led,3,0,0,0,23";O[3]="long,3,none,nomusic.mid,0,7,0,led,4,255,204,0,0,led,3,255,204,0,0,led,2,255,204,0,0,led,1,255,153,0,0,led,0,255,153,0,1,led,1,0,0,0,1,led,0,0,0,0,2,led,1,255,153,0,2,led,0,255,153,0,3,led,1,0,0,0,3,led,0,0,0,0,4,led,1,255,153,0,4,led,0,255,153,0,5,led,1,0,0,0,5,led,0,0,0,0,6,led,1,255,153,0,6,led,0,255,153,0,7,led,1,0,0,0,7,led,0,0,0,0,8,led,2,0,0,0,8,led,1,0,238,0,8,led,0,255,153,0,9,led,0,0,0,0,9,led,2,255,153,0,10,led,2,0,0,0,10,led,0,255,153,0,11,led,0,0,0,0,11,led,2,255,153,0,12,led,2,0,0,0,12,led,0,255,153,0,13,led,0,0,0,0,13,led,2,255,153,0,14,led,2,0,0,0,14,led,0,255,153,0,15,led,0,0,0,0,15,led,2,255,153,0,16,led,2,0,0,0,16,led,0,255,153,0,17,led,0,0,0,0,17,led,2,255,153,0,18,led,2,0,0,0,18,led,0,255,153,0,19,led,3,0,0,0,19,led,0,0,0,0,19,led,2,0,238,0,20,led,3,255,153,0,20,led,0,255,153,0,21,led,3,0,0,0,21,led,0,0,0,0,22,led,3,255,153,0,22,led,0,255,153,0,23,led,3,0,0,0,23,led,0,0,0,0,24,led,3,255,153,0,24,led,0,255,153,0,25,led,3,0,0,0,25,led,0,0,0,0,26,led,4,0,0,0,26,led,3,0,238,0,26,led,0,255,153,0,27,led,0,0,0,0,27,led,4,255,153,0,28,led,4,0,0,0,28,led,0,255,153,0,29,led,0,0,0,0,29,led,4,255,153,0,30,led,4,0,0,0,30,led,0,255,153,0,31,led,0,0,0,0,31,led,4,255,153,0,32,led,4,0,0,0,32,led,0,255,153,0,33,led,0,0,0,0,33,led,4,255,153,0,34,led,4,0,0,0,34,led,0,255,153,0,35,led,0,0,0,0,35,led,4,255,153,0,36,led,4,0,0,0,36,led,0,255,153,0,37,led,0,0,0,0,37,led,4,255,153,0,38,led,4,0,0,0,38,led,0,255,153,0,39,led,0,0,0,0,39,led,4,255,153,0,40,led,4,0,0,0,40";O[4]="long,3,none,nomusic.mid,1,7,0,led,0,255,255,255,1,led,0,255,230,233,2,led,0,255,204,219,3,led,0,255,179,211,4,led,0,255,153,210,5,led,0,255,128,217,6,led,0,255,102,231,7,led,0,255,76,252,8,led,0,231,51,255,9,led,0,196,25,255,10,led,0,153,0,255,11,led,0,200,28,255,12,led,0,238,56,255,13,led,0,255,85,244,14,led,0,255,113,224,15,led,0,255,142,213,16,led,0,255,170,210,17,led,0,255,199,216,18,led,0,255,227,231,19,led,0,255,255,255,20,led,0,0,0,0,20,led,1,0,0,0,20,led,2,0,0,0,20,led,3,0,0,0,20,led,4,0,0,0";for(i=0;i<=4;i++){I=new SWFObject("../include_flash/CDLEditor.swf","flashNab","160","160","7",null,true);I.addVariable("cdll",O[i]);I.addParam("wmode","transparent");if(!I.write("helpNab"+(i+1))){var F=document.getElementById("helpNab"+(i+1));if(F){F.innerHTML=I.getSWFHTML()}}}startOnlineStatusCheck($("#userId").val());$("#idFormMAC").ajaxForm({target:"#contentCreerCompte",beforeSubmit:beforeFormAction,success:function(){register.init();msgHandling.simpleMsgShow()}});var G={beforeSubmit:function(S,R,U){var T=false;if(checkemail($("input[@name=email]").val())==false){msgHandling.errorMsgShowDisplay({text:msg_txt["reg_invalid_email"],name:"email"});return false}beforeFormAction(S,R,U)},success:function(){$("#idFormContact").unblock();msgHandling.simpleMsgShow($("div.result-contact-form").html());$("textarea[@name=message]").val("")}};$("#idFormContact").submit(function(){$("#myMacAddress").val($("#numSerie").val());$(this).ajaxSubmit(G);return false});break;case"vie_commune":$("#bloc-generic-register ul li").eq(3).addClass("reg-weAreHere");K=function(){register.goPreferences(true)};$("div.intro-cadre-content img").setOpacity(0.5);$("a.bt_AddFoyer").bind("click",DuppAddLine);$("a.bt_Remove:first").hide();$("a.bt_Remove").click(DuppRemoveLine);G={target:"#contentCreerCompte",beforeSubmit:function(S,R,Y){var X="";var V=false;var W=false;var U=false;var T=false;$("#form_VieCommune [name~=leve], #form_VieCommune [name~=couche]").each(function(){if($(this).val()==""){T=true}});$("tr.line-duplicate").each(function(){if($("input[@name=who]",this).val()!=""){V=($("input[@name=date]",this).val()=="")}});if(T){X+="&bull;"+msg_txt["register_bad_sleeping_hours"]+"<br />"}if(V){error=true;X+="&bull;"+msg_txt["register_bad_foyer_date"]+"<br />"}if(X!=""){customAlertN(X);return false}else{beforeFormAction(S,R,Y)}},success:function(){register.init()}};$("#form_VieCommune").submit(function(){$("tr.line-duplicate").each(function(){var R=$("select[@name=annee]",this).val()+"-"+$("select[@name=mois]",this).val()+"-"+$("select[@name=jour]",this).val();if(!checkDate(R)){}else{$("input[@name=date]",this).val(R)}});$(this).ajaxSubmit(G);return false});break;case"preferences":$("#bloc-generic-register ul li").eq(4).addClass("reg-weAreHere");K=function(){register.goMusicUpload(register.userObject)};$("div.intro-cadre-content img").setOpacity(0.6);$("input[@name=authorisation]").click(function(){$("input[@name=notification]").attr("checked",false)});$("input[@name=notification]").click(function(){$("input[@name=authorisation]").attr("checked",false)});$("#spoken-lang-profil .selected input").click(function(){return false});$("#spoken-lang-profil .selected input").attr("disabled",true);$("#form_Prefs").ajaxForm({target:"#contentCreerCompte",beforeSubmit:beforeFormAction,success:function(){register.init()}});break;case"music_upload":$("#bloc-generic-register ul li").eq(5).addClass("reg-weAreHere");K=function(){register.goFriends(register.userObject)};$("div.intro-cadre-content img").setOpacity(0.7);var G={target:"#contentCreerCompte",beforeSubmit:function(S,R,U){var T=$("#musicFile").val().substr($("#musicFile").val().length-4,4).toUpperCase();if(fieldIsEmpty("musicName")){customAlertN(msg_txt["mp3_invalidName"]);return false}if(fieldIsEmpty("musicFile")){customAlertN(msg_txt["mp3_invalidFile"]);return false}if(T!=".MP3"){customAlertN(msg_txt["mp3_notAnMp3"]);return false}beforeFormAction(S,R,U);return true},success:function(){msgHandling.simpleMsgShow();register.init(J,"music_upload")}};$("#form-uploadMp3").ajaxForm(G);$("#bt_goFriends").bind("click",function(){var R=$(this).parents("div.contentMainTab");$(R).block();$(R).load("myRegisterFriends.do",{"dispatch":"load"},function(){register.init()})});$("ul.reg-mp3-list li a.LdeleteIcone").click(function(){var R=$(this).attr("href");var S=this;customConfirmN(msg_txt["confirm_delete"],null,function(){$(S).parents("li").destroyMe();$.get(R)});return false});break;case"friends":$("#bloc-generic-register ul li").eq(6).addClass("reg-weAreHere");K=function(){register.goMyself(register.userObject,true)};$("div.intro-cadre-content img").setOpacity(0.8);G={target:"#contentCreerCompte",beforeSubmit:function(S,R,T){beforeFormAction(S,R,T);return true},success:function(){register.init();msgHandling.simpleMsgShow()}};if($("#contentTellFriends").length>0){G.target="#contentTellFriends";var H=$("form[@name=myRegisterFriendsForm]").attr("action");$("form[@name=myRegisterFriendsForm]").attr("action",Url.argReplace("fromMessages","true",H))}$("#form-addFriends").submit(function(){var U=new RegExp("[ ,;]+");var V=$("#myListOfFriends").val().split(U);var S="";if(V.length>0&&$("#myListOfFriends").val().length>0){for(var T=0;T<V.length;T++){var R=V[T];var X=checkemail(R);if(X==false&&$.trim(R)!=""){S+="<strong>"+R+"</strong>&nbsp;&nbsp;&nbsp;&nbsp;"}}}else{customAlertN(msg_txt["register_error_friends_empty"]);return false}if(S!=""){customAlertN(msg_txt["register_badEmailList"]+"<br />"+S);return false}else{$("input.myFriendmail").remove();for(var T=0;T<V.length;T++){var R=V[T];var W=$("<input class='myFriendmail' type='hidden' name='address' value='"+R+"' />");$("#myListOfFriends").after(W)}}$(this).ajaxSubmit(G);return false});$("a.popup-preview").click(function(){window.open("myRegisterFriends.do?dispatch=previsualisation","","resizable=no, location=no, width=740, height=600, menubar=no, status=no, scrollbars=yes, menubar=no")});break;case"myself":$("#bloc-generic-register ul li").eq(7).addClass("reg-weAreHere");K=function(){register.goMyself(register.userObject,true)};$("div.intro-cadre-content img").setOpacity(0.9);$("#form-myself").ajaxForm({target:"#contentCreerCompte",beforeSubmit:beforeFormAction,success:function(){register.init()}});break;case"recap":$("#bloc-generic-register ul li").eq(9).addClass("reg-weAreHere");$("div.intro-cadre-content img").setOpacity(1);G={beforeSubmit:function(S,R,T){if(!checkemail($("input[@name=address]").val())&&($("#mailCheckBox").attr("checked"))){customAlertN(msg_txt["reg_invalid_email"]);return false}beforeFormAction(S,R,T)},success:function(){redirect("myNablife.do")}};$("#form-recap").submit(function(){$(this).ajaxSubmit(G);return false});break;case"vrai_fin_finale":$("#bloc-generic-register img.wizard-img-indic").remove();$("#bloc-generic-register li").removeClass();$("#bloc-generic-register li").addClass("reg-weAreNotHere");mainMenuSwitch("show");$("#mainLogo a").unbind("click");break}var N=false;$("#bloc-generic-register ul li").each(function(){if($(this).is(".reg-weAreHere")){if(($.browser.msie&&ie7)||(!($.browser.msie))){$(this).prepend(M)}else{}N=true}if(!N){$(this).addClass("reg-weAreNotHere")}});if(K!=null){$("div.reg-back a").click(K)}}}}()